# helm-charts

This repository contains two Helm charts that correspond to different cluster registration methods:

### 1. `ciroos` Chart
Deploys the Sveltos applier and a Secret containing a Kubeconfig for accessing the Ciroos control cluster. This chart is the Helm equivalent of **Method 1: Single Cluster Registration (YAML Manifest)**.

**How it works:**
- Values are generated by Ciroos during the registration process
- Each chart/value pair registers a single cluster
- Applied directly to the target cluster

### 2. `installer` Chart
Deploys a Ciroos Job that connects to the Ciroos control cluster, registers the cluster, and then deploys the Sveltos applier to the local cluster. This chart is the Helm equivalent of **Method 2: Bootstrap YAML (Self-Service Registration)**.

**How it works:**
- Values are generated by Ciroos at the project/organization level (not cluster-specific)
- The token and most values can be reused across multiple clusters
- **User must specify the cluster name** in the values for each cluster
- The Job handles the registration workflow automatically
- Self-deletes after successful completion (5 minutes)

**Key Difference:** The `ciroos` chart requires pre-registration and fully cluster-specific values generated by Ciroos, while the `installer` chart uses reusable project-level credentials but still requires the user to provide a unique cluster name for each deployment.


### ciroos helm chart

Prepare values.yaml. Following fields must be set

```
clusterNamespace: <cluster namespace>
clusterName: <cluster name>
pullmodeSecret:
  kubeconfig: <base64 encoded kubeconfig for sveltos applier to connect to Ciroos control cluster>
```

```
helm repo add ciroos https://ciroos-ai.github.io/helm-charts
helm repo update
helm install ciroos ciroos/ciroos --create-namespace -n projectsveltos  -f /tmp/values.yaml
```

### installer helm chart

Prepare values.yaml. Following fields must be set

```
bootstrap:
  bootstrap:
    env:
      apiUrl: https://qa0.ciroos.ai
      clusterName: <cluster name>
token:
  secretName: ciroos-token
  token: <base64 encoded API token>

```


```
helm repo add ciroos https://ciroos-ai.github.io/helm-charts
helm repo update
helm install ciroos ciroos/installer --create-namespace -n projectsveltos  -f /tmp/values.yaml
```
